## 换个角度看硬件
### ISA 
指令集体系结构，指的是处理器支持的指令和字节级编码，定义机器级程序的格式和行为，定义处理器的状态，指令的格式，指令对状态的影响。

### Y86-64指令集体系结构
包括四部分：状态单元，指令集和它们的编码，一组编程规范，异常事件处理

#### 可见状态
1. 程序寄存器
2. 条件码
3. PC
4. 内存
5. 程序状态

#### 指令
- movq
- addq,subq,andq,xorq
- jmp,jle,jl,je,jne,jge,jg
- cmov
- call ret
- pushq popq
- halt

#### 编码
15个程序寄存器每个都有一个在0到0XE之间的寄存器标识符，这个标识符就是寄存器的地址。寄存器存在CPU中的寄存器文件中，这个文件是个小的随机访问存储器</br>
CISC 复杂指令集，RISC 精简指令集

### 逻辑设计与硬件控制语言HCL
数字系统需要的三部分：计算的组合逻辑，存储位的存储单元，控制存储单元更新的时钟信号

#### 逻辑门
HCL && || ！

#### 组合电路
位级：检测位相等，单个位的多路复用</br>
字级：字级相等检测，HCL允许比较指定位数的两个字 A==B。字级多路复用，用情况表达式描述
ALU：算术逻辑单元，输入：两个操作数，一个控制，控制值对应不同功能码

#### 集合关系
将一个信号与许多信号做比较。

#### 存储器和时钟
时序电路要求保存状态，必须引入存储设备。
1. 时钟寄存器，存储单个字或位，时钟控制寄存器加载输入值。如PC,条件代码，程序状态
2. 随机访问寄存器，即内存，存储多个字，需要地址信息来决定读写什么值。如寄存器文件。虚拟内存

硬件寄存器，在时钟信号发生跳变，才会更新输出值。</br>
寄存器文件有读写控制，地址，数据输入，时钟输入，数据输出。还有一个只读存储器，用来读取指令。一般这两个存储器会被合并为一个具有双端口的存储器，
一个用来读指令，一个用来读写数据。各个寄存器的地址就是他们的ID。

### 顺序实现
每个时钟周期上，SEQ执行处理一条指令所需的全部步骤。因此，时钟频率会很低很低。

#### 分阶段
所有指令执行都被分成相同的阶段，下一步是哪个阶段取决于正在执行的指令。
- 阶段
1. 取指：根据PC中的值，到对应内存中去取指令字节，寄存器ID，立即数，。计算下一条指令的地址，计算方法是  当前PC+取出来指令的长度
2. 译码：从寄存器文件中读入最多两个操作数。有可能是读入指令指明的寄存器，也可能是rsp栈指针寄存器
3. 执行：ALU执行计算功能，算加减乘除或基址偏移；栈指针增加或减少；检查条件。得到的值称作valE。
4. 访存：将数据写入内存；从内存中读出数据，读出的值叫valM。
5. 写回：最多将两个结果写回到寄存器文件
6. 更新PC： 将PC更新为下一条指令的地址
- 时序控制
1. PC装载新的地址：每个时钟周期
2. 条件码寄存器装载新的值：整数运算指令时
3. 写数据内存：rmmovq,pushq,call
4. 寄存器文件：写端口允许每个周期更新两个寄存器

### 流水线
- 通用原理
待执行的任务被划分为多个阶段，多个顾客可以同时经过系统，经过的速度一样。提高了吞吐量-单位时间处理任务的数量，但也增加了延迟，服务某些顾客的时间边长了。

#### 计算流水线








